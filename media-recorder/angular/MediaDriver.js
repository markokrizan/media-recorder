(()=>{var e={655:(e,t,r)=>{function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=function(e){"use strict";var t,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,o=Object.create(i.prototype),a=new M(n||[]);return o._invoke=function(e,t,r){var n=d;return function(i,o){if(n===p)throw new Error("Generator is already running");if(n===v){if("throw"===i)throw o;return P()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var c=S(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===d)throw n=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=p;var u=f(e,t,r);if("normal"===u.type){if(n=r.done?v:h,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=v,r.method="throw",r.arg=u.arg)}}}(e,r,a),o}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var d="suspendedStart",h="suspendedYield",p="executing",v="completed",m={};function y(){}function g(){}function b(){}var w={};w[a]=function(){return this};var R=Object.getPrototypeOf,E=R&&R(R(j([])));E&&E!==r&&i.call(E,a)&&(w=E);var O=b.prototype=y.prototype=Object.create(w);function x(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(o,a,c,u){var s=f(e[o],e,a);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"===n(d)&&i.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,c,u)}),(function(e){r("throw",e,c,u)})):t.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return r("throw",e,c,u)}))}u(s.arg)}var o;this._invoke=function(e,n){function i(){return new t((function(t,i){r(e,n,t,i)}))}return o=o?o.then(i,i):i()}}function S(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method))return m;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=f(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var o=i.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function _(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function j(e){if(e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,o=function r(){for(;++n<e.length;)if(i.call(e,n))return r.value=e[n],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:P}}function P(){return{value:t,done:!0}}return g.prototype=O.constructor=b,b.constructor=g,g.displayName=s(b,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,s(e,u,"GeneratorFunction")),e.prototype=Object.create(O),e},e.awrap=function(e){return{__await:e}},x(k.prototype),k.prototype[c]=function(){return this},e.AsyncIterator=k,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new k(l(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(O),s(O,u,"Generator"),O[a]=function(){return this},O.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=j,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&i.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return c.type="throw",c.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var u=i.call(a,"catchLoc"),s=i.call(a,"finallyLoc");if(u&&s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),_(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;_(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:j(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}("object"===n(e=r.nmd(e))?e.exports:{});try{regeneratorRuntime=i}catch(e){Function("r","regeneratorRuntime = r")(i)}}},t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={id:n,loaded:!1,exports:{}};return e[n](i,i.exports,r),i.loaded=!0,i.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var n={};(()=>{"use strict";function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function a(e,t,r,n,i,o,a){try{var c=e[o](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,i)}r.r(n),r.d(n,{DEFAULT_AUDIO_EXTENSION:()=>b,DEFAULT_VIDEO_EXTENSION:()=>w,DEFAULT_VIDEO_FORMAT:()=>g,DEVICE_TYPE_MICROPHONE:()=>m,DEVICE_TYPE_WEB_CAM:()=>v,ERROR_CODE_DEVICE_NOT_FOUND:()=>x,ERROR_CODE_PERMISSION_DENIED:()=>O,EVENT_ADD_DEVICE:()=>R,EVENT_REMOVE_DEVICE:()=>E,MediaDriverFactory:()=>ne,TAG_NAME_AUDIO:()=>p,TAG_NAME_VIDEO:()=>h,VIDEO_MAX_SIZE:()=>y,bytesToMB:()=>c,differenceBy:()=>u,generateRandomString:()=>d,getMediaBlobDuration:()=>s,getSecondsAsTimeString:()=>l,mapPluggedOutDevice:()=>f}),r(655);var c=function(e){return e/1048576},u=function(e,t,r){return e.filter((function(e){return!t.some((function(t){return t[r]===e[r]}))}))},s=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=document.createElement("video"),n=new Promise((function(e){return r.addEventListener("loadedmetadata",(function(){r.duration===1/0?(r.currentTime=Number.MAX_SAFE_INTEGER,r.ontimeupdate=function(){r.ontimeupdate=null,e(r.duration),r.currentTime=0}):e(r.duration),r.remove()}))})),r.src="string"==typeof t||t instanceof String?t:window.URL.createObjectURL(t),e.abrupt("return",n);case 4:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function c(e){a(o,n,i,c,u,"next",e)}function u(e){a(o,n,i,c,u,"throw",e)}c(void 0)}))});return function(e){return t.apply(this,arguments)}}(),l=function(e){if(Number.isInteger(e)){var t=new Date(0,0,0,0,0,e),r=t.getHours()>=1?11:14;return t.toISOString().substring(r,19)}},f=function(e,r){return(n=e,function(e){if(Array.isArray(e))return o(e)}(n)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).map((function(e){return e.deviceId===r.deviceId?t(t({},e),{},{isPluggedOut:!0}):e}));var n},d=function(){return Date.now().toString(36)+Math.random().toString(36).substr(2,9)},h="VIDEO",p="AUDIO",v="videoinput",m="audioinput",y=100,g="video/webm",b=".mp3",w=".webm",R="add_device",E="remove_device",O="permission_denied",x="device_not_found";function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _(e,t){return!t||"object"!==k(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){var t="function"==typeof Map?new Map:void 0;return(M=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return j(e,arguments,L(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),T(n,e)})(e)}function j(e,t,r){return(j=P()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&T(i,r.prototype),i}).apply(null,arguments)}function P(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var I,A=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(a,e);var t,r,n,i,o=(t=a,r=P(),function(){var e,n=L(t);if(r){var i=L(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return _(this,e)});function a(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){};return S(this,a),(r=o.call(this,e)).currentRecordedData=[],r.currentRecordingTimeElapsed=0,r.maxMediaSize=t,r.onStop=n,r.onRecordingError=i,r.onMediaRecordTick=c,r.ondataavailable=function(e){if(r._getTotalSize()>t&&"recording"===r.state)return r.stop();r.currentRecordedData.push(e.data)},r.onstop=function(){r.clear(),r.onStop()},r.onerror=function(e){r.clear(),r.onError(e)},r}return n=a,(i=[{key:"startRecording",value:function(){var e=this;this.sizeCheckTimer=setInterval((function(){"recording"===e.state&&e.requestData()}),500),this.start(),this.mediaTimeInterval=setInterval((function(){e.currentRecordingTimeElapsed=e.currentRecordingTimeElapsed+1,e.onMediaRecordTick(e.currentRecordingTimeElapsed)}),1e3)}},{key:"getRecordedMedia",value:function(){return this.currentRecordedData}},{key:"resetRecordedMedia",value:function(){this.currentRecordingTimeElapsed=0,this.currentRecordedData=[]}},{key:"_getTotalSize",value:function(){return this.currentRecordedData.reduce((function(e,t){return e+c(t.size)}),0)}},{key:"clear",value:function(){clearInterval(this.sizeCheckTimer),clearInterval(this.mediaTimeInterval),this.ondataavailable=null}}])&&D(n.prototype,i),a}(M(MediaRecorder));function N(e,t,r){return(N=B()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&U(i,r.prototype),i}).apply(null,arguments)}function F(e,t,r){return(F="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=z(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function C(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function V(e){var t=B();return function(){var r,n=z(e);if(t){var i=z(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return G(this,r)}}function G(e,t){return!t||"object"!==X(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function z(e){return(z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t,r,n,i,o,a){try{var c=e[o](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(n,i)}function H(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function a(e){Y(o,n,i,a,c,"next",e)}function c(e){Y(o,n,i,a,c,"throw",e)}a(void 0)}))}}function q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Z(e,t,r){return t&&W(e.prototype,t),r&&W(e,r),e}function $(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var J="Permission denied",K="Requested device not found",Q=($(I={},h,w),$(I,p,b),I),ee=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){},u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(){},s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:function(){},l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:function(){},f=arguments.length>10&&void 0!==arguments[10]?arguments[10]:function(){};if(q(this,e),!t)throw new Error("Provide a reference to a HTMLMediaElement (ex. <video /> or <audio/>) in order to use the API!");this.mediaElement=t,this.stream=null,this.mediaRecorder=null,this.currentRecordedMedia={},this.devices=[],this.maxMediaSize=r,this.onStop=n,this.onRecordingError=i,this.onMediaRecordTick=o,this.onStartRecording=a,this.onResetMediaData=c,this.onPlayMediaFrame=u,this.onPlaybackFinished=s,this.onDeviceChange=l,this.onDeviceLoad=f,this.init()}var t,r,n,i,o,a,c,l,f,h,p;return Z(e,[{key:"init",value:function(){navigator.mediaDevices.ondevicechange=this.handleDeviceChange.bind(this),this.loadDevices()}},{key:"showMediaFile",value:(p=H(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s(t);case 2:if(r=e.sent,this.currentRecordedMedia.file=t,this.currentRecordedMedia.duration=Math.round(r),this.mediaElement.ontimeupdate=this.handlePlayingMediaFrame.bind(this),this.mediaElement.removeAttribute("autoplay"),"object"!==X(t)){e.next=10;break}return this.mediaElement.src=URL.createObjectURL(t),e.abrupt("return");case 10:this.mediaElement.src=t;case 11:case"end":return e.stop()}}),e,this)}))),function(e){return p.apply(this,arguments)})},{key:"startRecording",value:(h=H(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.mediaRecorder=new A(this.stream,this.maxMediaSize,this.onStop,this.onRecordingError,this.onMediaRecordTick),this.mediaRecorder.startRecording(),this.onStartRecording();case 3:case"end":return e.stop()}}),e,this)}))),function(){return h.apply(this,arguments)})},{key:"stopRecording",value:(f=H(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopStream(),this.mediaElement.ontimeupdate=this.handlePlayingMediaFrame.bind(this),e.next=4,this.showRecordedMediaPreview();case 4:case"end":return e.stop()}}),e,this)}))),function(){return f.apply(this,arguments)})},{key:"resetMediaData",value:(l=H(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=this.mediaElement)||void 0===t||null===(r=t.removeAttribute)||void 0===r||r.call(t,"src"),null!==(n=this.mediaElement)&&void 0!==n&&n.ontimeupdate&&(this.mediaElement.ontimeupdate=null),this.mediaRecorder&&this.mediaRecorder.resetRecordedMedia(),this.currentRecordedMedia={},this.onResetMediaData();case 5:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"stopStream",value:function(){var e,t;null===(e=this.stream)||void 0===e||null===(t=e.getTracks)||void 0===t||t.call(e).forEach((function(e){return e.stop()}))}},{key:"loadDevices",value:(c=H(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return r=e.sent,e.abrupt("return",r.filter((function(e){return e.kind===t})));case 4:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"getDevices",value:function(){return this.devices}},{key:"setDevices",value:function(e){this.devices=e}},{key:"getDeviceStream",value:(a=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),function(e){return a.apply(this,arguments)})},{key:"showRecordedMediaPreview",value:(o=H(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.mediaElement.removeAttribute("autoplay"),t=new Blob(this.mediaRecorder.getRecordedMedia(),{type:g}),e.t0=t,e.t1=Math,e.next=6,s(t);case 6:e.t2=e.sent,e.t3=e.t1.round.call(e.t1,e.t2),this.currentRecordedMedia={file:e.t0,duration:e.t3},this.mediaElement.srcObject=null,this.mediaElement.src=URL.createObjectURL(this.currentRecordedMedia.file);case 11:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"handlePlayingMediaFrame",value:function(){if(this.mediaElement){var e=Math.round(this.mediaElement.currentTime),t=Math.floor(e/this.currentRecordedMedia.duration*100);this.onPlayMediaFrame({progressPercentage:t,timeElapsed:e}),e===this.currentRecordedMedia.duration&&this.onPlaybackFinished({progressPercentage:t})}}},{key:"handleDeviceChange",value:(i=H(regeneratorRuntime.mark((function e(){var t,r,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.loadDevices();case 2:if(t=e.sent,this.onDeviceChange){e.next=6;break}return this.devices=t,e.abrupt("return");case 6:this.devices.length<t.length?(r=u(t,this.devices,"deviceId")[0],this.onDeviceChange({event:R,device:r})):(n=u(this.devices,t,"deviceId")[0],this.onDeviceChange({event:E,device:n})),this.devices=t;case 8:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"playMedia",value:function(){var e,t;null===(e=this.mediaElement)||void 0===e||null===(t=e.play)||void 0===t||t.call(e)}},{key:"pauseMedia",value:function(){var e,t;null===(e=this.mediaElement)||void 0===e||null===(t=e.pause)||void 0===t||t.call(e)}},{key:"getRecordedMedia",value:function(){return this.currentRecordedMedia.file}},{key:"changeDevice",value:(n=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.stopStream(),e.next=3,this.resetMediaData();case 3:return e.next=5,this.loadStream(t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"retake",value:(r=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resetMediaData();case 2:return e.next=4,this.loadStream(t);case 4:return e.next=6,this.startRecording();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"clearRecording",value:(t=H(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resetMediaData();case 2:return e.next=4,this.loadStream();case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"download",value:function(){var e=URL.createObjectURL(this.getRecordedMedia()),t=document.createElement("a"),r=d()+Q[this.mediaElement.tagName];document.body.appendChild(t),t.style="display: none",t.href=e,t.download=r,t.click(),window.URL.revokeObjectURL(e),t.remove()}},{key:"clear",value:function(){this.stopStream(),navigator.mediaDevices.ondevicechange=null,this.mediaElement&&(this.mediaElement.ontimeupdate=null,this.mediaElement.removeAttribute("src"),this.mediaElement.srcObject=null),this.mediaRecorder&&this.mediaRecorder.clear()}}]),e}(),te=function(e){C(o,e);var t,r,n,i=V(o);function o(){q(this,o);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.call.apply(i,[this].concat(t))}return Z(o,[{key:"loadStream",value:(n=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.clear(),e.next=4,this.getVideoDeviceStream(t);case 4:this.stream=e.sent,this.mediaElement.setAttribute("autoplay",!0),this.mediaElement.srcObject=this.stream,e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(0),e.t0.message!==J){e.next=13;break}throw{code:O};case 13:if(e.t0.message!==K){e.next=15;break}throw{code:x};case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return n.apply(this,arguments)})},{key:"getVideoDeviceStream",value:(r=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,this.getDeviceStream({video:{deviceId:t},audio:!0});case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.getDeviceStream({video:!0,audio:!0});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"loadDevices",value:(t=H(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(z(o.prototype),"loadDevices",this).call(this,v);case 2:this.devices=e.sent,null===(t=this.onDeviceLoad)||void 0===t||t.call(this,this.devices);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),o}(ee),re=function(e){C(o,e);var t,r,n,i=V(o);function o(){q(this,o);for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.call.apply(i,[this].concat(t))}return Z(o,[{key:"loadStream",value:(n=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.clear(),e.next=4,this.getAudioDeviceStream(t);case 4:this.stream=e.sent,this.mediaElement.setAttribute("autoplay",!0),this.mediaElement.srcObject=this.stream,e.next=16;break;case 9:if(e.prev=9,e.t0=e.catch(0),e.t0.message!==J){e.next=13;break}throw{code:O};case 13:if(e.t0.message!==K){e.next=15;break}throw{code:x};case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e){return n.apply(this,arguments)})},{key:"getAudioDeviceStream",value:(r=H(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.next=3,this.getDeviceStream({video:!1,audio:{deviceId:t}});case 3:return e.abrupt("return",e.sent);case 4:return e.next=6,this.getDeviceStream({video:!1,audio:!0});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"loadDevices",value:(t=H(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(z(o.prototype),"loadDevices",this).call(this,m);case 2:this.devices=e.sent,null===(t=this.onDeviceLoad)||void 0===t||t.call(this,this.devices);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),o}(ee),ne=function(){function e(){q(this,e)}return Z(e,null,[{key:"create",value:function(e){for(var t=e.tagName,r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];switch(t){case h:return N(te,[e].concat(n));case p:return N(re,[e].concat(n));default:return null}}}]),e}()})(),module.exports.mediaRecorderCore=n})();